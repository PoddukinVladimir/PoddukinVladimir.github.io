{"version":3,"sources":["../../../app/services/items.service.js"],"names":["angular","module","factory","$window","items","localStorage","getItem","getItemsFromLocalStorage","isTextEmpty","text","undefined","findIndexOfItemByID","id","i","length","generateGuid","s4","Math","floor","random","toString","substring","setItemsToLocalStorage","setItem","JSON","stringify","parse","getItems","addItem","push","Item","deleteItem","index","splice","addComment","item","comments","Comment"],"mappings":";;;;AAAAA,QAAQC,MAAR,CAAe,UAAf,EAA2BC,OAA3B,CAAmC,cAAnC,EAAmD,UAAUC,OAAV,EAAmB;;AAElE;AACA,QAAIC,QAAQ,EAAZ;;AAEA,QAAID,QAAQE,YAAR,CAAqBC,OAArB,CAA6B,eAA7B,MAAkD,MAAtD,EAA8D;AAC1DF,gBAAQG,0BAAR;AACH;;AAED;AACA,aAASC,WAAT,CAAqBC,IAArB,EAA2B;AACvB,eAAOA,SAASC,SAAT,IAAsBD,SAAS,EAAtC;AACH;;AAED,aAASE,mBAAT,CAA6BC,EAA7B,EAAiC;AAC7B,aAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIT,MAAMU,MAA1B,EAAkCD,GAAlC,EAAuC;AACnC,gBAAIT,MAAMS,CAAN,EAASD,EAAT,KAAgBA,EAApB,EAAwB;AACpB,uBAAOC,CAAP;AACH;AACJ;AACJ;;AAED,aAASE,YAAT,GAAwB;AACpB,iBAASC,EAAT,GAAc;AACV,mBAAOC,KAAKC,KAAL,CAAW,CAAC,IAAID,KAAKE,MAAL,EAAL,IAAsB,OAAjC,EACFC,QADE,CACO,EADP,EAEFC,SAFE,CAEQ,CAFR,CAAP;AAGH;;AAED,eAAOL,OAAOA,IAAP,GAAc,GAAd,GAAoBA,IAApB,GAA2B,GAA3B,GAAiCA,IAAjC,GAAwC,GAAxC,GAA8CA,IAA9C,GAAqD,GAArD,GAA2DA,IAA3D,GAAkEA,IAAlE,GAAyEA,IAAhF;AACH;;AAED,aAASM,sBAAT,GAAkC;AAC9BnB,gBAAQE,YAAR,CAAqBkB,OAArB,CAA6B,OAA7B,EAAsCC,KAAKC,SAAL,CAAerB,KAAf,CAAtC;AACH;;AAED,aAASG,wBAAT,GAAoC;AAChC,eAAOiB,KAAKE,KAAL,CAAWvB,QAAQE,YAAR,CAAqBC,OAArB,CAA6B,OAA7B,CAAX,CAAP;AACH;;AAED,WAAO;AACHqB,kBAAU,oBAAY;AAClB,mBAAOpB,0BAAP;AACH,SAHE;AAIHqB,iBAAS,iBAAUnB,IAAV,EAAgB;AACrB,gBAAID,YAAYC,IAAZ,CAAJ,EAAuB;AACvB,gBAAI,OAAOA,IAAP,KAAgB,QAApB,EAA8B;AAC1B,oBAAIG,KAAKG,cAAT;AACAX,sBAAMyB,IAAN,CAAW,IAAIC,IAAJ,CAASrB,IAAT,EAAeG,EAAf,CAAX;AACAU;AACH,aAJD,MAIO,IAAI,QAAOb,IAAP,yCAAOA,IAAP,OAAgB,QAApB,EAA8B;AACjCA,qBAAKG,EAAL,GAAUG,cAAV;AACAX,sBAAMyB,IAAN,CAAWpB,IAAX;AACAa;AACH;AACJ,SAfE;AAgBHS,oBAAY,oBAAUnB,EAAV,EAAc;AACtB,gBAAIoB,QAAQrB,oBAAoBC,EAApB,CAAZ;AACAR,kBAAM6B,MAAN,CAAaD,KAAb,EAAoB,CAApB;AACAV;AACH,SApBE;AAqBHX,6BAAqBA,mBArBlB;AAsBHuB,oBAAY,oBAAUC,IAAV,EAAgB1B,IAAhB,EAAsB;AAC9B,gBAAID,YAAYC,IAAZ,CAAJ,EAAuB;AACvB,gBAAIuB,QAAQrB,oBAAoBwB,KAAKvB,EAAzB,CAAZ;AACAR,kBAAM4B,KAAN,EAAaI,QAAb,CAAsBP,IAAtB,CAA2B,IAAIQ,OAAJ,CAAY5B,IAAZ,CAA3B;AACAa;AACH;AA3BE,KAAP;AA6BH,CArED","file":"items.service.js","sourcesContent":["angular.module('dairyApp').factory('itemsFactory', function ($window) {\r\n\r\n    // Model\r\n    let items = [];\r\n\r\n    if ($window.localStorage.getItem('isInitialized') === 'true') {\r\n        items = getItemsFromLocalStorage();\r\n    }\r\n\r\n    // Private methods\r\n    function isTextEmpty(text) {\r\n        return text === undefined || text === '';\r\n    }\r\n\r\n    function findIndexOfItemByID(id) {\r\n        for (let i = 0; i < items.length; i++) {\r\n            if (items[i].id === id) {\r\n                return i;\r\n            }\r\n        }\r\n    }\r\n\r\n    function generateGuid() {\r\n        function s4() {\r\n            return Math.floor((1 + Math.random()) * 0x10000)\r\n                .toString(16)\r\n                .substring(1);\r\n        }\r\n\r\n        return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();\r\n    }\r\n\r\n    function setItemsToLocalStorage() {\r\n        $window.localStorage.setItem('items', JSON.stringify(items));\r\n    }\r\n\r\n    function getItemsFromLocalStorage() {\r\n        return JSON.parse($window.localStorage.getItem('items'));\r\n    }\r\n\r\n    return {\r\n        getItems: function () {\r\n            return getItemsFromLocalStorage();\r\n        },\r\n        addItem: function (text) {\r\n            if (isTextEmpty(text)) return;\r\n            if (typeof text === 'string') {\r\n                let id = generateGuid();\r\n                items.push(new Item(text, id));\r\n                setItemsToLocalStorage();\r\n            } else if (typeof text === 'object') {\r\n                text.id = generateGuid();\r\n                items.push(text);\r\n                setItemsToLocalStorage();\r\n            }\r\n        },\r\n        deleteItem: function (id) {\r\n            let index = findIndexOfItemByID(id);\r\n            items.splice(index, 1);\r\n            setItemsToLocalStorage();\r\n        },\r\n        findIndexOfItemByID: findIndexOfItemByID,\r\n        addComment: function (item, text) {\r\n            if (isTextEmpty(text)) return;\r\n            let index = findIndexOfItemByID(item.id);\r\n            items[index].comments.push(new Comment(text));\r\n            setItemsToLocalStorage();\r\n        }\r\n    }\r\n});"]}